<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Ø§Ù„Ù…Ø¯Ø±Ø³Ø© Ø§Ù„Ø³Ø§Ø¯Ø³Ø© ÙˆØ§Ù„Ø¹Ø´Ø±ÙˆÙ† - ØªØ¨ÙˆÙƒ</title>
  <meta name="description" content="Ù†Ø¸Ø§Ù… ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø£Ù†Ø´Ø·Ø© ÙˆØ§Ù„Ø­ØµØµ â€” Ø§Ù„Ù…Ø¯Ø±Ø³Ø© Ø§Ù„Ø³Ø§Ø¯Ø³Ø© ÙˆØ§Ù„Ø¹Ø´Ø±ÙˆÙ† Ø¨ØªØ¨ÙˆÙƒ"/>

  <style>
    /* ====== Ù‡ÙˆÙŠØ©/Ø£Ù„ÙˆØ§Ù† (Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ø£ÙˆÙ„) ====== */
    :root{
      --primary:#2E7D32; --primary-2:#388E3C; --accent:#FFB300;
      --ink:#0f172a; --muted:#475569; --border:#e2e8f0;
      --container:min(1200px,94vw);
      --print-margin:12mm; /* Ù‡ÙˆØ§Ù…Ø´ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© */
    }
    *{box-sizing:border-box}
    html,body{margin:0;background:linear-gradient(135deg,var(--primary) 0%, var(--primary-2) 100%);color:var(--ink);font-family:"Segoe UI",system-ui,Arial,sans-serif;line-height:1.65}

    /* Ø¯ÙŠØ¨Ø§Ø¬Ø© Ø«Ø§Ø¨ØªØ© ÙÙŠ Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙÙ‚Ø· */
    .header-logo{background:#fff;padding:16px 20px;position:sticky;top:0;z-index:1000;border-bottom:1px solid var(--border);box-shadow:0 4px 12px rgba(0,0,0,.12)}
    .header-logo .wrap{width:var(--container);margin:auto}
    .header-logo img{width:100%;max-width:820px;max-height:110px;object-fit:contain;display:block;margin:auto}

    /* ØªÙ†Ù‚Ù„ */
    nav{background:rgba(255,255,255,.98);box-shadow:0 2px 10px rgba(0,0,0,.10)}
    .nav{width:var(--container);margin:auto;display:flex;justify-content:center;gap:12px;flex-wrap:wrap;padding:14px}
    .btn{border:0;border-radius:30px;padding:12px 28px;font-weight:700;cursor:pointer;color:#fff;background:linear-gradient(135deg,var(--primary),var(--primary-2));box-shadow:0 4px 14px rgba(46,125,50,.35);transition:.2s}
    .btn:hover{transform:translateY(-2px)}
    .btn.alt{background:linear-gradient(135deg,#00796B,#00897B)}

    /* ØµÙØ­Ø§Øª/Ø­Ø§ÙˆÙŠØ© */
    .container{width:var(--container);margin:auto;padding:24px}
    .card{background:#fff;border-radius:16px;padding:28px;box-shadow:0 12px 36px rgba(0,0,0,.25);margin:20px 0}
    .page{display:none}
    .page.active{display:block;animation:fade .3s}
    @keyframes fade{from{opacity:0;transform:translateY(18px)}to{opacity:1;transform:translateY(0)}}
    h1{color:var(--primary);text-align:center;margin:0 0 18px;font-size:34px}
    h2{color:var(--primary);border-right:6px solid var(--accent);padding-right:12px;margin:18px 0;font-size:22px}

    /* Ù†Ù…Ø§Ø°Ø¬ */
    .grid{display:grid;gap:12px}
    .grid-2{grid-template-columns:1fr 1fr}
    @media (max-width:900px){.grid-2{grid-template-columns:1fr}}
    label{display:flex;flex-direction:column;gap:6px}
    .input{padding:12px 14px;border:2px solid #ddd;border-radius:10px;background:#fafafa;font-size:16px}
    .input:focus{outline:none;border-color:var(--primary);box-shadow:0 0 0 4px rgba(46,125,50,.10)}
    textarea.input{min-height:110px;resize:vertical}

    .hint{color:var(--muted);font-size:.95rem}
    .actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:8px}

    /* Ø¹Ø±Ø¶ Ø§Ù„Ø´ÙˆØ§Ù‡Ø¯ (4 ÙÙ‚Ø·) */
    .witness-grid{display:grid;gap:14px;grid-template-columns:repeat(4,1fr)}
    .witness-grid img{height:160px;object-fit:cover;border-radius:12px;box-shadow:0 4px 16px rgba(0,0,0,.18);border:3px solid #4CAF50}
    @media (max-width:900px){.witness-grid{grid-template-columns:repeat(2,1fr)}}

    /* Ø¬Ø¯Ø§ÙˆÙ„ Ø®Ø¶Ø±Ø§Ø¡ */
    table{width:100%;border-collapse:separate;border-spacing:0}
    th,td{border:2px solid #4CAF50;padding:10px 8px}
    thead th{background:#e8f5e9;color:#0b3d3a}

    /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© = ØµÙØ­Ø© A4 Ø¨Ø¯ÙˆÙ† ØªØ°Ù„ÙŠÙ„ Ø§Ù„Ù…ÙˆÙ‚Ø¹ */
    .print-root{display:none}
    .print-frame{width:100%;border-collapse:collapse}
    .print-frame thead{display:table-header-group} /* ÙŠÙƒØ±Ø± Ø§Ù„Ø¯ÙŠØ¨Ø§Ø¬Ø© Ø£Ø¹Ù„Ù‰ ÙƒÙ„ ØµÙØ­Ø© */
    .print-header{padding-bottom:8px}
    .print-header img{width:100%;max-height:110px;object-fit:contain;display:block;margin:auto}
    .print-title{color:var(--primary);text-align:center;margin:6px 0 12px;font-size:22px}
    .box-grid{display:grid;grid-template-columns:1fr 1fr;gap:8px}
    .box{border:2px solid #4CAF50;border-radius:10px;padding:10px}
    .box .label{font-weight:700;margin-bottom:4px;color:#0f172a}
    .value{white-space:pre-wrap;word-break:break-word}
    .print-witness{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:6px}
    .print-witness img{height:90mm;object-fit:cover;border-radius:8px;border:2px solid #4CAF50}
    /* Ù…Ù†Ø¹ Ø§Ù†Ù‚Ø³Ø§Ù… Ø§Ù„Ø¹Ù†Ø§ØµØ± */
    .box, .print-witness img, .print-table tr{break-inside:avoid;page-break-inside:avoid}

    /* ØªØ°Ù„ÙŠÙ„ Ø§Ù„Ù…ÙˆÙ‚Ø¹ (Ù„Ø§ ÙŠÙØ·Ø¨Ø¹) */
    .site-footer{color:#fff;text-align:center;margin:16px 0 28px}
    .badge{display:inline-block;margin:4px;border:1px dashed rgba(255,255,255,.6);padding:6px 10px;border-radius:999px;background:rgba(255,255,255,.06)}

    /* Ø·Ø¨Ø§Ø¹Ø© Ù…Ø¶Ø¨ÙˆØ·Ø© */
    @media print{
      body{background:#fff}
      .header-logo, nav, .site-footer, .card form, .btn{display:none !important}
      .print-root{display:block !important}
      @page{size:A4; margin: var(--print-margin)}
      /* Ø¶Ø¨Ø· Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ù„ÙŠÙ„Ø§Ø¦Ù… A4 */
      .print-page{width: calc(210mm - 2 * var(--print-margin));}
    }
  </style>
</head>
<body>
  <!-- Ø¯ÙŠØ¨Ø§Ø¬Ø© Ø§Ù„Ù…ÙˆÙ‚Ø¹ (Ø«Ø§Ø¨ØªØ© Ø¨Ø§Ù„ØªØµÙØ­ ÙÙ‚Ø·) -->
  <header class="header-logo">
    <div class="wrap">
      <img src="26.png" alt="Ø¯ÙŠØ¨Ø§Ø¬Ø© Ø§Ù„Ù…Ø¯Ø±Ø³Ø© Ø§Ù„Ø³Ø§Ø¯Ø³Ø© ÙˆØ§Ù„Ø¹Ø´Ø±ÙˆÙ† Ø¨ØªØ¨ÙˆÙƒ"
           onerror="this.insertAdjacentHTML('afterend','<div class=&quot;hint&quot; style=&quot;color:#b91c1c;margin:.5rem 0&quot;>âš ï¸ Ø§Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±Ø© Ø¨Ø§Ø³Ù… <b>26.png</b> Ø¨Ø¬Ø§Ù†Ø¨ <b>index.html</b>.</div>'); this.remove();">
    </div>
  </header>

  <!-- ØªÙ†Ù‚Ù„ -->
  <nav>
    <div class="nav">
      <button class="btn" onclick="go('home')">Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
      <button class="btn alt" onclick="go('activities')">ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø£Ù†Ø´Ø·Ø©</button>
      <button class="btn" onclick="go('sessions')">ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø­ØµØµ</button>
    </div>
  </nav>

  <main class="container">
    <!-- Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
    <section id="home" class="card page active">
      <h1>Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠØ©</h1>
      <p class="hint">Ø§Ù…Ù„Ø£ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø«Ù… Ø§Ø¶ØºØ· <b>Ø·Ø¨Ø§Ø¹Ø© / PDF</b>. Ø§Ù„Ø¯ÙŠØ¨Ø§Ø¬Ø© ØªØ·Ø¨Ø¹ Ø¨Ø§Ù„Ø£Ø¹Ù„Ù‰ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§. Ø§Ù„ØªØ°Ù„ÙŠÙ„ Ù„Ø§ ÙŠØ¸Ù‡Ø± ÙÙŠ Ø§Ù„ØªÙ‚Ø±ÙŠØ±.</p>
    </section>

    <!-- ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø£Ù†Ø´Ø·Ø© -->
    <section id="activities" class="card page">
      <h1>ğŸ“Š ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù†Ø´Ø§Ø· Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠ</h1>

      <form id="actForm" class="grid">
        <div class="grid grid-2">
          <label>Ø§Ø³Ù… Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬<input class="input" name="title" required></label>
          <label>Ø§Ù„Ù…Ù†ÙØ°<input class="input" name="owner" required></label>
          <label>Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙÙˆÙ†<input class="input" name="beneficiaries" required></label>
          <label>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø³ØªÙÙŠØ¯ÙŠÙ†<input class="input" name="count" type="number" min="0" step="1" required></label>
          <label>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙ†ÙÙŠØ°<input class="input" type="date" name="date" required></label>
          <label>Ù…ÙƒØ§Ù† Ø§Ù„ØªÙ†ÙÙŠØ°<input class="input" name="place" required></label>
        </div>
        <label>Ø§Ù„Ø£Ù‡Ø¯Ø§Ù<textarea class="input" name="goals" rows="3" placeholder="Ø³Ø±Ø¯ Ù†Ù‚Ø·ÙŠ"></textarea></label>
        <label>ÙˆØµÙ Ù…Ø®ØªØµØ±<textarea class="input" name="desc" rows="3" placeholder="Ø§Ø®ØªÙŠØ§Ø±ÙŠ"></textarea></label>

        <div>
          <div class="actions">
            <input type="file" id="witnessFiles" accept="image/*" multiple hidden>
            <label for="witnessFiles" class="btn">Ø¥Ø¶Ø§ÙØ© ØµÙˆØ± Ø§Ù„Ø´ÙˆØ§Ù‡Ø¯ (Ø­Ø¯ Ø£Ù‚ØµÙ‰ 4)</label>
            <button class="btn alt" type="button" id="actPrintBtn">Ø·Ø¨Ø§Ø¹Ø© / PDF</button>
            <button class="btn" type="button" id="clearWitness">Ø­Ø°Ù Ø§Ù„ØµÙˆØ±</button>
          </div>
          <div id="witnessPreview" class="witness-grid"></div>
          <div class="hint" id="wCount">(0/4)</div>
        </div>
      </form>

      <!-- ØµÙØ­Ø© Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© (A4) Ù„Ù„Ø£Ù†Ø´Ø·Ø© -->
      <section id="activityPrint" class="print-root" aria-hidden="true">
        <div class="print-page">
          <table class="print-frame">
            <thead>
              <tr><th>
                <div class="print-header">
                  <img src="26.png" alt="Ø¯ÙŠØ¨Ø§Ø¬Ø©">
                  <div class="print-title">ØªÙ‚Ø±ÙŠØ± Ù†Ø´Ø§Ø· Ù…Ø¯Ø±Ø³ÙŠ</div>
                </div>
              </th></tr>
            </thead>
            <tbody>
              <tr><td>
                <div id="activityBoxes" class="box-grid" style="margin-bottom:10px"></div>

                <h2 style="margin:8px 0 6px">Ø§Ù„Ø´ÙˆØ§Ù‡Ø¯</h2>
                <div id="activityWitnessPrint" class="print-witness"></div>
              </td></tr>
            </tbody>
          </table>
        </div>
      </section>
    </section>

    <!-- ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø­ØµØµ -->
    <section id="sessions" class="card page">
      <h1>ğŸ“ ØªÙ‚Ø±ÙŠØ± Ø­ØµØµ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</h1>

      <form class="grid">
        <div class="grid grid-2">
          <label>Ø§Ù„ÙŠÙˆÙ…
            <select class="input" id="dayName" required>
              <option value="">Ø§Ø®ØªØ±</option>
              <option>Ø§Ù„Ø£Ø­Ø¯</option><option>Ø§Ù„Ø§Ø«Ù†ÙŠÙ†</option><option>Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡</option><option>Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡</option><option>Ø§Ù„Ø®Ù…ÙŠØ³</option>
            </select>
          </label>
          <label>Ø§Ù„ØªØ§Ø±ÙŠØ®<input class="input" type="date" id="sessionDate" required></label>
          <label>Ø§Ù„ØµÙ<input class="input" id="className" required placeholder="Ù…Ø«Ø§Ù„: Ø§Ù„Ø«Ø§Ù„Ø« Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ"></label>
          <label>Ø±Ù‚Ù… Ø§Ù„Ø­ØµØ©<input class="input" type="number" id="sessionNumber" min="1" max="10" required></label>
          <label>Ø§Ù„Ù…Ø¹Ù„Ù…Ø© Ø§Ù„ØºØ§Ø¦Ø¨Ø©<input class="input" id="absentTeacher" required></label>
        </div>
        <label>Ù…Ø§ ØªÙ… ØªÙ†ÙÙŠØ°Ù‡<textarea class="input" id="activitiesText" rows="3" required></textarea></label>

        <fieldset style="border:2px solid #4CAF50;border-radius:12px;padding:10px">
          <legend style="padding:0 .4rem;color:#0b3d3a">Ø§Ù„Ù…Ø¬Ø§Ù„</legend>
          <div class="actions">
            <label><input type="checkbox" id="basicSkills"> Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</label>
            <label><input type="checkbox" id="values"> Ø§Ù„Ù‚ÙŠÙ… ÙˆØ§Ù„Ù…ÙˆØ§Ø·Ù†Ø© Ø§Ù„ØµØ§Ù„Ø­Ø©</label>
            <label><input type="checkbox" id="futureSkills"> Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„</label>
          </div>
        </fieldset>

        <div class="actions" style="margin-top:8px">
          <button class="btn" type="button" onclick="addSession()">Ø­ÙØ¸ Ø§Ù„Ø­ØµØ©</button>
          <button class="btn alt" type="button" id="sesPrintBtn">Ø·Ø¨Ø§Ø¹Ø© / PDF</button>
          <button class="btn" type="button" onclick="clearAllSessions()">Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„</button>
        </div>
      </form>

      <h2>Ø§Ù„Ø­ØµØµ Ø§Ù„Ù…Ø³Ø¬Ù„Ø©</h2>
      <div style="overflow:auto;border:1px solid var(--border);border-radius:12px">
        <table id="sessionsTable">
          <thead>
            <tr>
              <th style="width:50px">Ù…</th><th style="width:90px">Ø§Ù„ÙŠÙˆÙ…</th><th style="width:120px">Ø§Ù„ØªØ§Ø±ÙŠØ®</th><th>Ø§Ù„ØµÙ</th>
              <th style="width:70px">Ø§Ù„Ø­ØµØ©</th><th style="width:160px">Ø§Ù„Ù…Ø¹Ù„Ù…Ø© Ø§Ù„ØºØ§Ø¦Ø¨Ø©</th><th style="min-width:260px">Ù…Ø§ ØªÙ… ØªÙ†ÙÙŠØ°Ù‡</th><th style="min-width:170px">Ø§Ù„Ù…Ø¬Ø§Ù„</th>
              <th class="no-print" style="width:90px">Ø¥Ø¬Ø±Ø§Ø¡</th>
            </tr>
          </thead>
          <tbody id="sessionsBody"></tbody>
        </table>
      </div>

      <!-- ØµÙØ­Ø© Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© (A4) Ù„Ù„Ø­ØµØµ -->
      <section id="sessionsPrint" class="print-root" aria-hidden="true">
        <div class="print-page">
          <table class="print-frame">
            <thead>
              <tr><th>
                <div class="print-header">
                  <img src="26.png" alt="Ø¯ÙŠØ¨Ø§Ø¬Ø©">
                  <div class="print-title">ØªÙ‚Ø±ÙŠØ± Ø­ØµØµ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</div>
                </div>
              </th></tr>
            </thead>
            <tbody>
              <tr><td>
                <table class="print-table" style="width:100%">
                  <thead>
                    <tr>
                      <th>Ù…</th><th>Ø§Ù„ÙŠÙˆÙ…</th><th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th><th>Ø§Ù„ØµÙ</th><th>Ø§Ù„Ø­ØµØ©</th><th>Ø§Ù„Ù…Ø¹Ù„Ù…Ø© Ø§Ù„ØºØ§Ø¦Ø¨Ø©</th><th>Ù…Ø§ ØªÙ… ØªÙ†ÙÙŠØ°Ù‡</th><th>Ø§Ù„Ù…Ø¬Ø§Ù„</th>
                    </tr>
                  </thead>
                  <tbody id="sessionsPrintBody"></tbody>
                </table>
              </td></tr>
            </tbody>
          </table>
        </div>
      </section>
    </section>

    <!-- ØªØ°Ù„ÙŠÙ„ Ø§Ù„Ù…ÙˆÙ‚Ø¹ â€” Ù„Ø§ ÙŠÙØ·Ø¨Ø¹ -->
    <footer class="site-footer">
      <span class="badge">Ù…Ø¯ÙŠØ±Ø© Ø§Ù„Ù…Ø¯Ø±Ø³Ø©: Ø£Ù…Ø§Ù†ÙŠ Ø¢Ù„ Ø¹Ø¨Ø´Ø§Ù†</span>
      <span class="badge">ØªØµÙ…ÙŠÙ… Ø§Ù„Ù‡ÙŠØ¦Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠØ©: Ø¹ÙŠØ¯Ø© ØµÙ„Ø§Ø­</span>
      <span class="badge">ØªØµÙ…ÙŠÙ… Ø§Ù„Ù‡ÙŠØ¦Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠØ©: Ù…Ù†ÙŠØ±Ø© Ø§Ù„Ø¹Ù…Ø±Ø§Ù†ÙŠ</span>
    </footer>
  </main>

  <script>
    /* ======= Ø£Ø¯ÙˆØ§Øª Ø¹Ø§Ù…Ø© ======= */
    const $ = (s,r=document)=>r.querySelector(s);
    const $$ = (s,r=document)=>[...r.querySelectorAll(s)];
    const store = {get:k=>JSON.parse(localStorage.getItem(k)||"[]"), set:(k,v)=>localStorage.setItem(k,JSON.stringify(v))};

    function go(id){ $$('.page').forEach(p=>p.classList.remove('active')); $('#'+id).classList.add('active'); scrollTo({top:0,behavior:'smooth'}); }
    const fmt = v => { try{return new Date(v).toLocaleDateString('ar-SA',{year:'numeric',month:'long',day:'numeric'})}catch{return v||''} };

    /* ======= Ø§Ù„Ø£Ù†Ø´Ø·Ø©: Ø´ÙˆØ§Ù‡Ø¯ = 4 ÙÙ‚Ø·ØŒ Ø·Ø¨Ø§Ø¹Ø© A4 ======= */
    const actForm = $('#actForm');
    const wInput  = $('#witnessFiles');
    const wPrev   = $('#witnessPreview');
    const wCount  = $('#wCount');
    let witness = [];

    function fileToDataURL(file){ return new Promise((res,rej)=>{ const fr=new FileReader(); fr.onload=()=>res(fr.result); fr.onerror=rej; fr.readAsDataURL(file); }); }

    wInput?.addEventListener('change', async (e)=>{
      witness=[]; wPrev.innerHTML="";
      const files=[...(e.target.files||[])].filter(f=>f.type.startsWith('image/')).slice(0,4);
      for(const f of files){
        const url=await fileToDataURL(f);
        witness.push({name:f.name,url});
        const img=new Image(); img.src=url; img.alt=f.name; img.loading='lazy';
        wPrev.appendChild(img);
      }
      wCount.textContent=`(${witness.length}/4)`;
    });

    $('#clearWitness')?.addEventListener('click', ()=>{
      witness=[]; if(wInput) wInput.value=""; wPrev.innerHTML=""; wCount.textContent="(0/4)";
    });

    function buildActivityPrint(){
      const d = Object.fromEntries(new FormData(actForm).entries());
      const req = ['title','owner','beneficiaries','count','date','place'];
      for(const k of req){ if(!d[k]){ alert('Ø£ÙƒÙ…Ù„ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ø£ÙˆÙ„Ø§Ù‹.'); return false; } }

      const fields = [
        ['Ø§Ø³Ù… Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬', d.title],
        ['Ø§Ù„Ù…Ù†ÙØ°', d.owner],
        ['Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙÙˆÙ†', d.beneficiaries],
        ['Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø³ØªÙÙŠØ¯ÙŠÙ†', d.count],
        ['ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙ†ÙÙŠØ°', fmt(d.date)],
        ['Ù…ÙƒØ§Ù† Ø§Ù„ØªÙ†ÙÙŠØ°', d.place],
        ['Ø§Ù„Ø£Ù‡Ø¯Ø§Ù', d.goals||'â€”'],
        ['ÙˆØµÙ Ù…Ø®ØªØµØ±', d.desc||'â€”'],
      ];
      $('#activityBoxes').innerHTML = fields.map(([k,v])=>`
        <div class="box"><div class="label">${k}</div><div class="value">${String(v).replace(/\n/g,'<br>')}</div></div>`).join('');

      const w = $('#activityWitnessPrint'); w.innerHTML="";
      witness.forEach(x=>{ const img=new Image(); img.src=x.url; img.alt=x.name; w.appendChild(img); });
      return true;
    }

    $('#actPrintBtn')?.addEventListener('click', ()=>{
      if(!buildActivityPrint()) return;
      const root = $('#activityPrint');
      root.style.display='block';
      const prev = document.title; document.title='ØªÙ‚Ø±ÙŠØ± Ù†Ø´Ø§Ø· - Ø§Ù„Ù…Ø¯Ø±Ø³Ø© 26';
      setTimeout(()=>window.print(), 20);
      window.onafterprint = ()=>{ root.style.display='none'; document.title=prev; window.onafterprint=null; };
    });

    /* ======= Ø§Ù„Ø­ØµØµ: Ø­ÙØ¸ Ù…Ø­Ù„ÙŠ + Ø·Ø¨Ø§Ø¹Ø© A4 ======= */
    let sessions = store.get('sessionsData');
    function renderSessions(){
      const body = $('#sessionsBody');
      body.innerHTML = sessions.map((s,i)=>`
        <tr>
          <td>${i+1}</td><td>${s.day}</td><td>${fmt(s.date)}</td><td>${s.className}</td>
          <td>${s.number}</td><td>${s.teacher}</td>
          <td style="text-align:right">${s.activities}</td><td style="text-align:right">${s.fields}</td>
          <td class="no-print"><button class="btn" style="background:linear-gradient(135deg,#D32F2F,#C62828)" onclick="delSession(${i})">Ø­Ø°Ù</button></td>
        </tr>`).join('');
    }
    function addSession(){
      const day=$('#dayName').value.trim();
      const date=$('#sessionDate').value;
      const cls=$('#className').value.trim();
      const num=$('#sessionNumber').value.trim();
      const t=$('#absentTeacher').value.trim();
      const acts=$('#activitiesText').value.trim();
      const fields=[];
      if($('#basicSkills').checked) fields.push('Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©');
      if($('#values').checked) fields.push('Ø§Ù„Ù‚ÙŠÙ… ÙˆØ§Ù„Ù…ÙˆØ§Ø·Ù†Ø© Ø§Ù„ØµØ§Ù„Ø­Ø©');
      if($('#futureSkills').checked) fields.push('Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„');
      if(!day||!date||!cls||!num||!t||!acts||!fields.length){ alert('Ø£ÙƒÙ…Ù„ ÙƒÙ„ Ø§Ù„Ø­Ù‚ÙˆÙ„ ÙˆØ§Ø®ØªØ± Ù…Ø¬Ø§Ù„Ø§Ù‹ ÙˆØ§Ø­Ø¯Ù‹Ø§ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„.'); return; }

      sessions.push({day,date,className:cls,number:num,teacher:t,activities:acts,fields:fields.join('ØŒ ')});
      store.set('sessionsData',sessions); renderSessions();
      ['dayName','sessionDate','className','sessionNumber','absentTeacher','activitiesText'].forEach(id=>$('#'+id).value="");
      ['basicSkills','values','futureSkills'].forEach(id=>$('#'+id).checked=false);
    }
    function delSession(i){ if(!confirm('Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ø­ØµØ©ØŸ')) return; sessions.splice(i,1); store.set('sessionsData',sessions); renderSessions(); }
    function clearAllSessions(){ if(!sessions.length){alert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø­ØµØµ');return;} if(confirm('Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­ØµØµØŸ')){ sessions=[]; store.set('sessionsData',sessions); renderSessions(); } }

    function buildSessionsPrint(){
      if(!sessions.length){ alert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø­ØµØµ Ù„Ù„Ø·Ø¨Ø§Ø¹Ø©'); return false; }
      $('#sessionsPrintBody').innerHTML = sessions.map((s,i)=>`
        <tr>
          <td>${i+1}</td><td>${s.day}</td><td>${fmt(s.date)}</td><td>${s.className}</td>
          <td>${s.number}</td><td>${s.teacher}</td>
          <td style="text-align:right">${s.activities}</td><td style="text-align:right">${s.fields}</td>
        </tr>`).join('');
      return true;
    }

    $('#sesPrintBtn')?.addEventListener('click', ()=>{
      if(!buildSessionsPrint()) return;
      const root = $('#sessionsPrint');
      root.style.display='block';
      const prev = document.title; document.title='ØªÙ‚Ø±ÙŠØ± Ø­ØµØµ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± - Ø§Ù„Ù…Ø¯Ø±Ø³Ø© 26';
      setTimeout(()=>window.print(), 20);
      window.onafterprint = ()=>{ root.style.display='none'; document.title=prev; window.onafterprint=null; };
    });

    // ØªØ´ØºÙŠÙ„ Ø£ÙˆÙ„ÙŠ
    renderSessions();
  </script>
</body>
</html>
